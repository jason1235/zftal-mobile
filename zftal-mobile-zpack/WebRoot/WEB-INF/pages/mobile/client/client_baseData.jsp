<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%><%@ taglib prefix="s" uri="/struts-tags"%><%@taglib prefix="ct" uri="/custom-code"%><%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %><%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %> <!DOCTYPE html><html><head><meta chaset="UTF-8"><%@ include file="/WEB-INF/pages/mobile/web/new/meta.jsp" %><%@ include file="/WEB-INF/pages/mobile/web/new/js.jsp" %><link rel="stylesheet" href="<%=request.getContextPath() %>/assets/css/global.css"><script type="text/javascript" src="<%=request.getContextPath() %>/js/hrm/application.js"></script><script type="text/javascript"> /**网页中的JS调用IOS客户端函数，需要在网页的JS代码中添加如下函数：*/function connectWebViewJavascriptBridge(callback) {		if (window.WebViewJavascriptBridge) {			callback(WebViewJavascriptBridge)		} else {			document.addEventListener('WebViewJavascriptBridgeReady', function() {				callback(WebViewJavascriptBridge)			}, false)		}	};var toPage = 1;	$(function(){	$("#bt").val("");	var jsgzList = '${pageList}';	var type = '${type}';    var items = ${viewList};    var titleItems = ${titleViewables};    var commonItems = ${commonViewables};        var contentHtml = "";    if(titleItems.length == 0 && commonItems.length == 0){	    $("#message").show();	   	}else{	   	if (items && items.length != 0) {		    	for (var i = 0, len = items.length; i < len; i++) {		 	       contentHtml += "  <li class='am-g am-list-item-desced'> ";		    		if(titleItems){		    				contentHtml += " <a onclick=\"clientBaseDetailData('" + items[i].values.globalid + "')\" class='am-list-item-hd '> ";			    			for ( var m = 0; m < titleItems.length; m++) {			    			  //alert(new Date(10339200000));			    			  	if((items[i].values[titleItems[m].fieldName]) instanceof Object){	    							//Data date=new Date(items[i].values[commonItems[m].fieldName].time);									var year=items[i].values[titleItems[m].fieldName].year+1900;									var month=items[i].values[titleItems[m].fieldName].month+1;									var day=items[i].values[titleItems[m].fieldName].date;									var dateStr=year+"-"+month+"-"+day;	    							contentHtml += dateStr;	    						}    							else{    								if(items[i].values[titleItems[m].fieldName] == undefined){    									contentHtml += "(空)";    								}else{	    								contentHtml += items[i].values[titleItems[m].fieldName];    								}    							}		    					 contentHtml += "&nbsp;&nbsp;&nbsp;&nbsp;";							}							contentHtml += " </a>  ";		    		}		    				    		if(commonItems){		    				//contentHtml += " <div class='am-list-item-text'> ";		    				contentHtml += "  <a onclick=\"clientBaseDetailData('" + items[i].values.globalid + "')\" > <div class=''><font size='2' color='#8E8E8E'> ";	    					for ( var m = 0; m < commonItems.length; m++) {	    						contentHtml += commonItems[m].name +":&nbsp;&nbsp; ";	    						if((items[i].values[commonItems[m].fieldName]) instanceof Object){	    							//Data date=new Date(items[i].values[commonItems[m].fieldName].time);									var year=items[i].values[commonItems[m].fieldName].year+1900;									var month=items[i].values[commonItems[m].fieldName].month+1;									var day=items[i].values[commonItems[m].fieldName].date;									var dateStr=year+"-"+month+"-"+day;	    							contentHtml += dateStr;	    						}    							else{    								if(items[i].values[commonItems[m].fieldName] == undefined){    									contentHtml += "(空)";    								}else{	    								contentHtml += items[i].values[commonItems[m].fieldName];    								}    							}    										    					contentHtml += "&nbsp;&nbsp;&nbsp;&nbsp;";							}							contentHtml += " </font> </div> </a>";		    		}		    	   contentHtml += " </li> ";		    	}	    		   		}	   		$("#message").hide();	   			   	}	   		   	if(jsgzList == '[]'){	   		$("#message").show();	   	}else{	   		$("#message").hide();	   	}	   		   	$("#itemslist").append(contentHtml);		   		   	$("#querydata").click(function(){	   		var queryData = $(".s_input").val();	   		var classId  = $("#xxlid").val();	   		var type   = $("#type").val();	   		//window.location.href = "<%=request.getContextPath() %>/basedata/basedata_clientBaseData.html?queryData="+queryData+"&classId="+classId+"&type="+type+"&submit=1";	   		$.post("<%=request.getContextPath() %>/basedata/basedata_clientBaseData.html",	   				"queryData="+queryData+"&classId="+classId+"&type="+type+"&submit=1",function(data){	   		                if(data.success){	   								   							var clazz = data.clazz;	   						    var items = data.viewList;	   						    var titleItems = data.titleViewables;	   						    var commonItems = data.commonViewables;	   						    //alert(items.length);	   						    	   						    var contentHtml = "";	   						    if(titleItems.length != 0 || commonItems.length != 0){	   							    	   							   	if (items && items.length != 0) {	   								    	for (var i = 0, len = items.length; i < len; i++) {	   								 	       contentHtml += "  <li class='am-g am-list-item-desced'> ";	   								    		if(titleItems){	   								    				contentHtml += " <a onclick=\"clientBaseDetailData('" + items[i].values.globalid + "')\" class='am-list-item-hd '> ";	   									    			for ( var m = 0; m < titleItems.length; m++) {	   									    			  //alert(new Date(10339200000));	   									    			  	if((items[i].values[titleItems[m].fieldName]) instanceof Object){	   							    							//Data date=new Date(items[i].values[commonItems[m].fieldName].time);	   															var year=items[i].values[titleItems[m].fieldName].year+1900;	   															var month=items[i].values[titleItems[m].fieldName].month+1;	   															var day=items[i].values[titleItems[m].fieldName].date;	   															var dateStr=year+"-"+month+"-"+day;	   							    							contentHtml += dateStr;	   							    						}	   						    							else{	   						    								if(items[i].values[titleItems[m].fieldName] == undefined){	   						    									contentHtml += "(空)";	   						    								}else{	   						    								contentHtml += items[i].values[titleItems[m].fieldName];	   						    								}	   						    							}	   								    					 contentHtml += "&nbsp;&nbsp;&nbsp;&nbsp;";	   													}	   													contentHtml += " </a>  ";	   								    		}	   								    			   								    		if(commonItems){	   								    				//contentHtml += " <div class='am-list-item-text'> ";	   								    				contentHtml += " <div class=''> <a onclick=\"clientBaseDetailData('" + items[i].values.globalid + "')\" > <font size='2' color='#8E8E8E'> ";	   							    					for ( var m = 0; m < commonItems.length; m++) {	   							    						contentHtml += commonItems[m].name +":&nbsp;&nbsp; ";	   							    						if((items[i].values[commonItems[m].fieldName]) instanceof Object){	   							    							//Data date=new Date(items[i].values[commonItems[m].fieldName].time);	   															var year=items[i].values[commonItems[m].fieldName].year+1900;	   															var month=items[i].values[commonItems[m].fieldName].month+1;	   															var day=items[i].values[commonItems[m].fieldName].date;	   															var dateStr=year+"-"+month+"-"+day;	   							    							contentHtml += dateStr;	   							    						}	   						    							else{	   						    								if(items[i].values[commonItems[m].fieldName] == undefined){	   						    									contentHtml += "(空)";	   						    								}else{	   						    								contentHtml += items[i].values[commonItems[m].fieldName];	   						    								}	   						    							}	   						    									   								    					contentHtml += "&nbsp;&nbsp;&nbsp;&nbsp;      ";	   													}	   													contentHtml += " </font> </a></div>   ";	   								    		}	   								    		   								    	   contentHtml += " </li> ";	   								    	}	   							    		   							   		}	   							   	}	   						 	$("#itemslist").empty();	   							$("#itemslist").append(contentHtml);   		   							   		   		                }	   		            },"json");	   	})	   		   	if(type == '2'){	   			connectWebViewJavascriptBridge(function(bridge) {				var callbackButton = document.getElementById('buttons');				callbackButton.onclick = function(e) {					e.preventDefault();					bridge.callHandler('testObjcCallback', function(response) {		                               					});				}			});	   			   	}	   		   	$(window).scroll(function(){	   		if ($(window).scrollTop() + $(window).height() >= $(document).height()) {    			loadMoreList();    		}	   	});});function loadMoreList(){		toPage++;		var queryData = $(".am-form-field").val();   		var classId  = $("#xxlid").val();   		var type   = $("#type").val();		$.post("<%=request.getContextPath() %>/basedata/basedata_getMore.html",		"query.toPage="+toPage+"&queryData="+queryData+"&classId="+classId+"&type="+type,function(data){                if(data.success){										var clazz = data.clazz;				    var items = data.viewList;				    var titleItems = data.titleViewables;				    var commonItems = data.commonViewables;				    //alert(items.length);				    				    var contentHtml = "";				    if(clazz.identityName != 'M_JSGZ'){				    if(titleItems.length != 0 || commonItems.length != 0){					    					   	if (items && items.length != 0) {						    	for (var i = 0, len = items.length; i < len; i++) {						 	       contentHtml += "  <li class='am-g am-list-item-desced'> ";						    		if(titleItems){						    				contentHtml += " <a onclick=\"clientBaseDetailData('" + items[i].values.globalid + "')\" class='am-list-item-hd '> ";							    			for ( var m = 0; m < titleItems.length; m++) {							    			  //alert(new Date(10339200000));							    			  	if((items[i].values[titleItems[m].fieldName]) instanceof Object){					    							//Data date=new Date(items[i].values[commonItems[m].fieldName].time);													var year=items[i].values[titleItems[m].fieldName].year+1900;													var month=items[i].values[titleItems[m].fieldName].month+1;													var day=items[i].values[titleItems[m].fieldName].date;													var dateStr=year+"-"+month+"-"+day;					    							contentHtml += dateStr;					    						}				    							else{				    								if(items[i].values[titleItems[m].fieldName] == undefined){					    									contentHtml += "(空)";					    								}else{					    								contentHtml += items[i].values[titleItems[m].fieldName];					    								}				    							}						    					 contentHtml += "&nbsp;&nbsp;&nbsp;&nbsp;";											}											contentHtml += " </a>  ";						    		}						    								    		if(commonItems){						    				//contentHtml += " <div class='am-list-item-text'> ";						    				contentHtml += " <div class=''> <a onclick=\"clientBaseDetailData('" + items[i].values.globalid + "')\" > <font size='2' color='#8E8E8E'> ";					    					for ( var m = 0; m < commonItems.length; m++) {					    						contentHtml += commonItems[m].name +":&nbsp;&nbsp; ";					    						if((items[i].values[commonItems[m].fieldName]) instanceof Object){					    							//Data date=new Date(items[i].values[commonItems[m].fieldName].time);													var year=items[i].values[commonItems[m].fieldName].year+1900;													var month=items[i].values[commonItems[m].fieldName].month+1;													var day=items[i].values[commonItems[m].fieldName].date;													var dateStr=year+"-"+month+"-"+day;					    							contentHtml += dateStr;					    						}				    							else{				    								if(items[i].values[commonItems[m].fieldName] == undefined){				    									contentHtml += "(空)";				    								}else{				    								contentHtml += items[i].values[commonItems[m].fieldName];				    								}				    							}				    														    					contentHtml += "&nbsp;&nbsp;&nbsp;&nbsp;      ";											}											contentHtml += " </font> </a></div>   ";						    		}						    							    	   contentHtml += " </li> ";						    	}					    						   		}					   	}					$("#itemslist").append(contentHtml);   						   	}else if(clazz.identityName == 'M_JSGZ'){					   		 var items = data.viewList;					   		 if (items && items.length != 0) {						    	for (var i = 0, len = items.length; i < len; i++) {						    		var aa = items[i].values.globalid;						    		var str = items[i].values.ffyf;						    		str =  str.replace("T"," "); 					    		    str =  str.replace(/-/g,"/");					    		   	var ffyfstr = new Date(str).format('yyyy年MM月');					    		   	var str1 = items[i].values.ffsj;					    		   	str1 =  str.replace("T"," "); 					    		    str1 =  str1.replace(/-/g,"/");					    		   	var ffsj = new Date(str1).format('yyyy-MM-dd hh:mm:ss');					    		   	console.log(ffsj);					    		   	var sfgz = parseFloat(items[i].values.sfgz).toFixed(2);						    		contentHtml +=   " <li class='am-g am-list-item-desced'> <div style='float:left;'> <h3 class='am-list-item-hd'>"				                           + " <a onclick='clientBaseDetailData("+ items[i].values.globalid +")'> " 				                           + ffyfstr +"工资条 </a></h3><div class='am-list-item-text'>" 			                    		   + " 发放时间: "+ ffsj				                           + " </div></div><div style='float:right;'><div class='am-list-item-text' align='right'>实发合计</div>  <div>" 				                    	   + sfgz +"元   " 				                           + " </div></div></li>  " ;						    	}					    	}					   		$("#jsgzul").append(contentHtml); 					   							   						                				            					   	}					   	                }else{//没有返回数据时                                      }            },"json");}Date.prototype.format =function(format){    var o = {    "M+" : this.getMonth()+1, //month	"d+" : this.getDate(),    //day	"h+" : this.getHours(),   //hour	"m+" : this.getMinutes(), //minute	"s+" : this.getSeconds(), //second	"q+" : Math.floor((this.getMonth()+3)/3),  //quarter	"S" : this.getMilliseconds() //millisecond    }    if(/(y+)/.test(format)) format=format.replace(RegExp.$1,    (this.getFullYear()+"").substr(4- RegExp.$1.length));    for(var k in o)if(new RegExp("("+ k +")").test(format))    format = format.replace(RegExp.$1,    RegExp.$1.length==1? o[k] :    ("00"+ o[k]).substr((""+ o[k]).length));    return format;}function clientBaseDetailData(globalid){		var classId = $("#xxlid").val();		var type   = $("#type").val();		$.post("<%=request.getContextPath() %>/basedata/basedata_clientBaseDetailCheck.html",		"globalid="+globalid+"&classId="+classId,function(data){                if(data.success){					window.location.href = "<%=request.getContextPath() %>/basedata/basedata_clientBaseDetailData.html?globalid="+globalid+"&classId="+classId+"&type="+type;                }else{                    //alert(data.text);	                    var $modal = $('#your-modal');					        $modal.modal();					      					                   }            },"json");};/**网页中的JS调用android客户端函数，只需在网页的JS代码中直接调用客户端提供的调用函数即可，网页例子如下所示*/function ShowAlert(){ MobileJavaApi.ShowAlertQuit("弹出消息提示");};function Quit(){	MobileJavaApi.Quit();};function GoBack(){	MobileJavaApi.GoBack();};</script><style type="text/css">.center {    text-align: center;    border: 1px dotted black;    width: 50%;}.am-navbar-default .am-navbar-nav {            /*background-color: #3c3c3c;*/        }        .am-offcanvas-bar {            left: auto;            right: 0;            -webkit-transform: translateX(100%);            -ms-transform: translateX(100%);            transform: translateX(100%);        }        .am-offcanvas-bar:after {            right: auto;            left: 0;        }        .am-menu-nav {            width: 33.33333333%;        }</style><title></title></head><body style="background: white;height: auto;"><div class="am-modal am-modal-no-btn" tabindex="-1" id="your-modal">  <div class="am-modal-dialog">    <div class="am-modal-hd">提示      <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>    </div>    <div class="am-modal-bd">     	 没有设置可以显示的详情数据!    </div>  </div></div><div data-am-sticky="" class="" style="margin: 0px;"><input type="hidden" value="${classId}" id="xxlid" name="classId"/><input type="hidden" value="${type}" id="type" name="type"/>		<%--    <header class="header">          	<c:if test="${type == '1' }" >          		<a onclick="GoBack()" class="back">          	</c:if>          	          	<c:if test="${type == '2' }" >          		<a id="buttons" class="back">          	</c:if>    --%>        <%--  	          	<c:if test="${type != '1' && type != '2'}" >          		 <header class="header">              <a href="<%=request.getContextPath() %>/portal/portal_portal.html" class="back">          	                    	  返回              </a>        			<div class="header_title">${clazz.name }</div>               </header>    		</c:if>    		    <%--    </header>  --%>  <c:if test="${clazz.identityName != 'M_JSGZ'}" ><div  class="search po_ab"  style="top:0px" >		<div class="search_i"><input type="text" id="bt" class="s_input am-form-field" placeholder="${conString}"></div>		<input id="querydata" type="button" onclick="search()" class="s_but " value="搜索">	</div></c:if></div>	<c:if test="${clazz.identityName != 'M_JSGZ'}" >	    <br><br>	    </c:if>    <div data-am-widget="list_news" class="am-list-news am-list-news-default" >  <!--列表标题-->    <!--<div class="am-list-news-hd am-cf">       带更多链接        <a href="###" class="">          <h2>栏目标题</h2>            <span class="am-list-news-more am-fr">更多 &raquo;</span>        </a>          </div>  -->		<div class="am-panel am-panel-default" id="message">    	<div class="am-panel-bd">没有对列表内容进行配置或者没有您的数据！</div>	</div>	<c:if test="${clazz.identityName != 'M_JSGZ'}" >  <div class="am-list-news-bd">  <ul class="am-list" id="itemslist">  </ul>  </div></c:if>	      <c:if test="${clazz.identityName eq 'M_JSGZ'}" > 	 <div class="am-list-news am-list-news-default" >       <ul class="am-list" id="jsgzul">		  <c:forEach items="${pageList }" var="jsgzItem" >		                            				            <li class="am-g am-list-item-desced">				                <div style="float:left;">				                    <h3 class="am-list-item-hd">				                    <a onclick="clientBaseDetailData('${jsgzItem.values.globalid}')">				                    <fmt:formatDate value="${jsgzItem.values.ffyf}" pattern="yyyy年MM月" />工资条				                    </a>				                    </h3>				                    <div class="am-list-item-text">				                    	发放时间：<fmt:formatDate value="${jsgzItem.values.ffsj}" type="both"/>  				                    </div>				                </div>				                <div style="float:right;">				                    <div class="am-list-item-text" align="right">实发合计</div>				                    <div>				                    	${jsgzItem.values.sfgz}元 				                    </div>				                </div>				            </li>				     		   </c:forEach>          </ul>     </div>  </c:if>          <!--<div class="am-list-news-ft">        <a class="am-list-news-more am-btn am-btn-default " href="###">点击加载更多 &raquo;</a>      </div>      -->            <c:if test="${clazz.identityName != 'M_JSGZ' }" >    </div>  </c:if><c:if test="${clazz.identityName eq 'M_JSGZ' || clazz.identityName eq 'M_KYLW'}" ><c:if test="${ type != '1' && type != '2'}" ><div data-am-widget="navbar" class="am-navbar am-cf am-navbar-default  testNavClass am-no-layout" id="">          <ul class="am-navbar-nav am-cf am-avg-sm-3">              <li>                <a href="<%=request.getContextPath() %>/mobile/web_index.html" class="">                      <span class="am-icon-home"></span>                    <span class="am-navbar-label">首页</span>                </a>              </li>              <li>                <a href="<%=request.getContextPath() %>/mobile/web_appCenter.html" class="">                      <span class="am-icon-th-large"></span>                    <span class="am-navbar-label">应用中心</span>                </a>              </li>              <li>                <a href="<%=request.getContextPath() %>/portal/portal_portal.html" class="">                      <span class="am-icon-user"></span>                    <span class="am-navbar-label">我的门户</span>                </a>              </li>          </ul>      </div></c:if></c:if></body></html>